\subsection{macOS \& Reverse Engineering}

% how the theme is relevant to your problem

In the past macOS has typically remained a less restricted and locked-down operating system compared to iOS. macOS did not have a Kernel Cache, instead the OS shipped with a "Base Image" that contained an XNU kernel binary located at a specific directory, and kernel extensions located at another, separated into user-space and kernel-space KEXTs. They were all Mach-O's, they just weren't bundled together in a single file like with other Apple operating systems.

% a comparison of the findings from the sources relevant to your problem

\subsubsection{ARM-based macOS}

There are two types of Mac's that used ARM-based processors. First are the T2 Mac's, and second are the "Apple Silicon" Mac's.

A "T2-enabled Mac" is a macOS device that uses an Intel x86\_64 processor as its primary Application Processor, and an ARM-based chip, typically a design from an older generation iPhone, that is used as a security co-processor. On these machines, the T2 handles a Secure Boot chain, Apple Pay and Touch ID. \cite{duo-labs-t2-intro}

The T2 acts essentially as its own system, handling requests for the main processor. It runs a slimmed-down version of watchOS, and therefore uses the same system architecture as iOS devices (watchOS is a derivative of iOS), known as BridgeOS. This OS has a Kernel Cache that acts the same as it does on iOS, therefore a tool designed for analysing firmware files of iOS devices would work just fine with BridgeOS.

The second type is an "Apple Silicon" Mac. These machines use ARM-based processors designed by Apple, much like in the iPhone or iPad. There is no need for a T2 chip on these machines, so BridgeOS is not present, however macOS has been modified so that it too uses a Kernel Cache in much the same way. Linux kernel developer Hector Martin, who is currently heading a project to port the Linux Kernel to the ARM-based Mac's, notes the following about the Kernel cache on macOS:

\begin{verbatim}
	"The built-in bootloader actually boots iBoot2 
	from /System/Volumes/Preboot/(UUID)/boot/(long 
	hash)/usr/standalone/firmware/iBoot.img4, and 
	that then loads the Darwin kernel from /System/
	Volumes/Preboot/(UUID)/boot/(long hash)/System/
	Library/Caches/com.apple.kernelcaches/kernelcache."
\end{verbatim}

From this, we now understand that ARM-based Mac's use the same kernel cache as iOS and BridgeOS, and most likely the same format too (the Kernel cache format appears to be dependent on either OS version or CPU). Therefore, like BridgeOS, support for the Mac's cache file should be automatic. 


\subsubsection{Intel-based macOS}

On Intel-based Mac's, however, there is again a different format. Intel-based Mac's do not use a Kernel Cache file, rather they store the plain XNU kernel Mach-O file at one directory, /System/Library/Kernels/kernel, and make use of a concept called "Kernel Collections"





% what you learnt collectively from these sources


% how the findings have influenced your initial solutions
